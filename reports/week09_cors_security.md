# ðŸ”’ CORS ì •ì±…ê³¼ ì›¹ ë³´ì•ˆ ê¸°ë³¸ ê°œë…: Origin, Header, Preflight ìš”ì²­ ì´í•´

------------------------------------------------------------------------

## 1. ì›¹ ë³´ì•ˆê³¼ CORS ê°œìš”

### ðŸ“Œ CORSëž€?

-   **Cross-Origin Resource Sharing**ì˜ ì•½ìž
-   ë¸Œë¼ìš°ì €ê°€ **ë‹¤ë¥¸ ì¶œì²˜(Origin)** ì˜ ìžì› ìš”ì²­ì„ ì œì–´í•˜ê¸° ìœ„í•œ **ë³´ì•ˆ
    ë©”ì»¤ë‹ˆì¦˜**
-   ê¸°ë³¸ì ìœ¼ë¡œ ë¸Œë¼ìš°ì €ëŠ” **ë™ì¼ ì¶œì²˜ ì •ì±…(Same-Origin Policy, SOP)** ì„
    ì ìš©í•˜ì—¬, ë‹¤ë¥¸ ì¶œì²˜ì˜ ìš”ì²­ì„ ì°¨ë‹¨í•¨

### âœ… ë™ì¼ ì¶œì²˜(Same-Origin)ì˜ ì •ì˜

-   **Origin = Protocol + Domain + Port**
-   ì˜ˆì‹œ:
    -   `https://example.com:443`\
    -   `http://example.com:80` â†’ í¬íŠ¸ì™€ í”„ë¡œí† ì½œì´ ë‹¤ë¥´ë¯€ë¡œ ì„œë¡œ ë‹¤ë¥¸
        Origin

------------------------------------------------------------------------

## 2. CORS ë™ìž‘ ì›ë¦¬

### âœ… ê¸°ë³¸ ìš”ì²­ (Simple Request)

-   ì¡°ê±´ ì¶©ì¡± ì‹œ ë³„ë„ì˜ ì‚¬ì „ ê²€ì‚¬(Preflight) ì—†ì´ ìš”ì²­ ì „ì†¡
-   ì¡°ê±´:
    -   ë©”ì„œë“œ: `GET`, `POST`, `HEAD` ë§Œ í—ˆìš©
    -   í—¤ë”: `Accept`, `Content-Type(ë‹¨ìˆœê°’)`, `Origin` ë“± ì œí•œëœ ê¸°ë³¸
        í—¤ë”ë§Œ ê°€ëŠ¥
    -   Content-Type: `text/plain`, `application/x-www-form-urlencoded`,
        `multipart/form-data`

### âœ… Preflight ìš”ì²­ (ì‚¬ì „ ìš”ì²­)

-   `OPTIONS` ë©”ì„œë“œë¡œ ì„œë²„ì— ë¨¼ì € "ì´ ìš”ì²­ í—ˆìš©í•´ë„ ë˜ë‚˜ìš”?" ë¼ê³ 
    ë¬¼ì–´ë´„
-   ì„œë²„ê°€ í—ˆìš©í•˜ë©´ ì‹¤ì œ ìš”ì²­ ì§„í–‰
-   ë³µìž¡ ìš”ì²­(ì˜ˆ: `PUT`, `DELETE`, `PATCH`, ì»¤ìŠ¤í…€ í—¤ë” í¬í•¨)ì´ ìžˆì„ ë•Œ
    ìˆ˜í–‰

------------------------------------------------------------------------

## 3. CORS ê´€ë ¨ ì£¼ìš” í—¤ë”

  --------------------------------------------------------------------------------------------
  í—¤ë”                                 ì„¤ëª…                    ì˜ˆì‹œ
  ------------------------------------ ----------------------- -------------------------------
  `Origin`                             ìš”ì²­ì„ ë³´ë‚¸ ì¶œì²˜        `Origin: https://client.com`

  `Access-Control-Allow-Origin`        í—ˆìš©í•  ì¶œì²˜             `*` ë˜ëŠ” `https://client.com`

  `Access-Control-Allow-Methods`       í—ˆìš©í•  HTTP ë©”ì„œë“œ      `GET, POST, PUT, DELETE`

  `Access-Control-Allow-Headers`       í—ˆìš©í•  ìš”ì²­ í—¤ë”        `Content-Type, Authorization`

  `Access-Control-Allow-Credentials`   ì¿ í‚¤/ì¸ì¦ì •ë³´ í—ˆìš© ì—¬ë¶€ `true`

  `Access-Control-Max-Age`             Preflight ìºì‹œ ì‹œê°„(ì´ˆ  `3600`
                                       ë‹¨ìœ„)                   
  --------------------------------------------------------------------------------------------

------------------------------------------------------------------------

## 4. ì˜ˆì œ íë¦„

### ðŸ§© Preflight ìš”ì²­ ì˜ˆì‹œ

``` http
OPTIONS /api/data HTTP/1.1
Host: api.server.com
Origin: https://client.com
Access-Control-Request-Method: PUT
Access-Control-Request-Headers: Content-Type, Authorization
```

### ðŸ§© ì„œë²„ ì‘ë‹µ ì˜ˆì‹œ

``` http
HTTP/1.1 204 No Content
Access-Control-Allow-Origin: https://client.com
Access-Control-Allow-Methods: GET, POST, PUT
Access-Control-Allow-Headers: Content-Type, Authorization
Access-Control-Max-Age: 3600
```

â†’ ì´í›„ ë¸Œë¼ìš°ì €ëŠ” `PUT /api/data` ìš”ì²­ì„ ì •ìƒì ìœ¼ë¡œ ì „ì†¡í•¨

------------------------------------------------------------------------

## 5. ì›¹ ë³´ì•ˆê³¼ CORSì˜ ê´€ê³„

### âœ… CORSì˜ ëª©ì 

-   í´ë¼ì´ì–¸íŠ¸(ë¸Œë¼ìš°ì €)ì™€ ì„œë²„ ê°„ ìžì› ê³µìœ ë¥¼ **ë³´ì•ˆì ìœ¼ë¡œ í—ˆìš©**í•˜ê¸°
    ìœ„í•¨
-   ì„œë²„ì—ì„œ í—ˆìš©í•˜ì§€ ì•Šìœ¼ë©´ ë¸Œë¼ìš°ì €ê°€ ì°¨ë‹¨

### âœ… ì›¹ ë³´ì•ˆ ê¸°ë³¸ ì›ì¹™

-   **ì¸ì¦(Authentication)**: ì‚¬ìš©ìžë¥¼ ì‹ë³„ (ex. JWT, ì„¸ì…˜ ì¿ í‚¤)
-   **ì¸ê°€(Authorization)**: ê¶Œí•œì— ë”°ë¼ ì ‘ê·¼ ì œì–´
-   **ë¬´ê²°ì„±(Integrity)**: ë°ì´í„°ê°€ ë³€ì¡°ë˜ì§€ ì•Šë„ë¡ ë³´ìž¥
-   **ê¸°ë°€ì„±(Confidentiality)**: ë¯¼ê°í•œ ì •ë³´ ë³´í˜¸ (ex. HTTPS, ì•”í˜¸í™”)
-   **ë¡œê·¸ ë° ëª¨ë‹ˆí„°ë§**: ê³µê²© ì‹œë„ ì¶”ì  ë° ë°©ì–´

------------------------------------------------------------------------

## 6. CORS ì„¤ì • (Express.js ì˜ˆì œ)

``` js
import express from "express";
import cors from "cors";

const app = express();

app.use(cors({
  origin: "https://client.com",  // í—ˆìš©í•  Origin
  methods: ["GET", "POST", "PUT", "DELETE"],
  allowedHeaders: ["Content-Type", "Authorization"],
  credentials: true              // ì¿ í‚¤, ì¸ì¦ì •ë³´ í¬í•¨ í—ˆìš©
}));

app.get("/api/data", (req, res) => {
  res.json({ message: "CORS ìš”ì²­ ì„±ê³µ!" });
});

app.listen(4000, () => console.log("Server running on port 4000"));
```

------------------------------------------------------------------------

## 7. CORS ë² ìŠ¤íŠ¸ í”„ëž™í‹°ìŠ¤

  í•­ëª©               ê¶Œìž¥ ë°©ì‹
  ------------------ -------------------------------------------
  Origin í—ˆìš©        `*` ë³´ë‹¤ëŠ” íŠ¹ì • ë„ë©”ì¸ ëª…ì‹œ
  Credentials        í•„ìš”í•œ ê²½ìš°ì—ë§Œ `true` ì„¤ì •
  Preflight ìµœì í™”   `Access-Control-Max-Age` í™œìš©
  ë³´ì•ˆ ê°•í™”          HTTPS ì‚¬ìš©, ë¯¼ê° ì •ë³´ í—¤ë” ìµœì†Œí™”
  ì—ëŸ¬ ì²˜ë¦¬          ë¸Œë¼ìš°ì € ì½˜ì†” ì˜¤ë¥˜ í™•ì¸ í›„ ì„œë²„ ì„¤ì • ì¡°ì •

------------------------------------------------------------------------

## ðŸ’¡ í•µì‹¬ ìš”ì•½

-   **CORS**ëŠ” ë¸Œë¼ìš°ì €ì˜ **ë™ì¼ ì¶œì²˜ ì •ì±…(SOP)** í•œê³„ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•œ
    ë³´ì•ˆ ë©”ì»¤ë‹ˆì¦˜\
-   ìš”ì²­ì€ **Simple Request**ì™€ **Preflight Request**ë¡œ ë‚˜ë‰¨\
-   ì„œë²„ëŠ” **CORS ê´€ë ¨ ì‘ë‹µ í—¤ë”**ë¥¼ í†µí•´ í—ˆìš© ì—¬ë¶€ë¥¼ ëª…ì‹œí•´ì•¼ í•¨\
-   ì˜¬ë°”ë¥¸ ì„¤ì • ì—†ì´ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ìš”ì²­ì´ ì°¨ë‹¨ë¨\
-   **Origin ê´€ë¦¬, ìµœì†Œ ê¶Œí•œ ì›ì¹™, HTTPS ì ìš©**ì€ í•„ìˆ˜ì ì¸ ì›¹ ë³´ì•ˆ
    ì „ëžµìž„

------------------------------------------------------------------------

> ìž‘ì„±ìž: \[ë°•ìž¬í›ˆ\]


> ë‚ ì§œ: 2025-08-10
